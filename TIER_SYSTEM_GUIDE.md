# 티어 시스템 가이드

## 개요

기존의 레벨 시스템을 점수 기반 티어 시스템으로 업그레이드했습니다.

## 티어 구분

회원의 정기전 에버에 따라 9단계로 구분됩니다 (배치 포함):

| 티어     | 점수 범위  | 색상         | 설명        |
| -------- | ---------- | ------------ | ----------- |
| 배치     | 기록 없음  | 회색(기울임) | 신규/미배치 |
| 아이언   | 100점 이하 | 회색         | 초보자      |
| 브론즈   | 101-130점  | 브론즈       | 입문자      |
| 실버     | 131-160점  | 실버         | 초급자      |
| 골드     | 161-190점  | 골드         | 중급자      |
| 플레티넘 | 191-220점  | 플래티넘     | 고급자      |
| 다이아   | 221-250점  | 다이아몬드   | 전문가      |
| 마스터   | 251-280점  | 보라색       | 마스터      |
| 챌린저   | 281점 이상 | 빨간색       | 최고수      |

## 주요 변경사항

### 1. 데이터베이스

- `members` 테이블에 `tier` 컬럼 추가
- `scores` 테이블에 시즌 정보 컬럼 추가:
  - `is_regular_season`: 정기전 여부
  - `season_year`: 시즌 연도
  - `season_half`: 반기 구분 ('first_half' 또는 'second_half')
- 기존 `level` 컬럼은 레거시 호환성을 위해 유지

### 2. 정기전 에버 기반 티어 계산

- 스코어가 추가/수정/삭제될 때마다 자동으로 티어 재계산
- 정기전 에버 기준으로 티어 결정
- 반기별로 초기화되는 시스템

#### 에버 계산 우선순위:

1. **현재 반기 이후의 정기전 기록** (예: 25년 7월 이후)
2. **현재 반기 이전의 정기전 기록** (예: 25년 1~6월)
3. **이전 연도 하반기 기록** (예: 24년 7~12월)
4. **이전 연도 상반기 기록** (예: 24년 1~6월)
5. **기록이 없으면 '배치' 등급**

#### 반기 구분:

- **상반기**: 1월 ~ 6월
- **하반기**: 7월 ~ 12월

### 3. UI 개선

- 티어별 색상 구분으로 시각적 개선
- 회원 목록에서 티어 정보 표시
- 회원 등록/수정 시 티어 선택 가능

### 4. API 업데이트

- 회원 조회 시 `tier` 정보 포함
- 통계에 `tier_counts` 추가
- 구글 시트 가져오기에서 티어 정보 처리

## 마이그레이션 실행

### 1. 데이터베이스 마이그레이션

```bash
cd backend
python migrations/run_tier_migration.py
```

### 2. 서버 재시작

```bash
# 백엔드 서버 재시작
python app.py

# 프론트엔드 서버 재시작 (개발 환경)
cd frontend
npm start
```

## 사용법

### 1. 회원 등록/수정

- 회원 등록 시 티어를 직접 선택할 수 있습니다
- 티어를 선택하지 않으면 점수 기반으로 자동 계산됩니다

### 2. 스코어 관리

- 스코어를 추가/수정/삭제하면 해당 회원의 티어가 자동으로 업데이트됩니다
- 정기전 에버를 기준으로 계산됩니다

### 3. 구글 시트 연동

- 구글 시트에 '티어' 컬럼을 추가하여 티어 정보를 관리할 수 있습니다
- 지원되는 티어: 배치, 아이언, 브론즈, 실버, 골드, 플레티넘, 다이아, 마스터, 챌린저

## 레거시 호환성

- 기존 `level` 필드는 그대로 유지되어 하위 호환성을 보장합니다
- 기존 데이터는 자동으로 새로운 티어 시스템으로 마이그레이션됩니다

## 주의사항

- 마이그레이션 실행 전 데이터베이스 백업을 권장합니다
- 정기전 기록이 없는 회원은 '배치' 등급으로 설정됩니다
- 티어는 정기전 에버로 계산되므로, 정기전에 참여하지 않은 회원은 '배치' 등급이 됩니다
- 스코어 입력 시 자동으로 시즌 정보(연도, 반기)가 설정됩니다
